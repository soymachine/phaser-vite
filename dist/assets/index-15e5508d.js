var x=Object.defineProperty;var b=(h,e,t)=>e in h?x(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var d=(h,e,t)=>(b(h,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class i{}i.version="0.1.5";i.LEFT="LEFT";i.RIGHT="RIGHT";i.TOP="TOP";i.BOTTOM="BOTTOM";i.CENTER="CENTER";i.LANDSCAPE="LANDSCAPE";i.PORTRAIT="PORTRAIT";i.easing="Cubic.easeOut";class a{constructor(){this.events={}}subscribe(e="",t){this.events[e]==null&&(this.events[e]=[]),this.events[e].push(t)}unsubscribe(e="",t){this.events[e]!=null&&(this.events[e]=this.events[e].filter(n=>n!==t))}notify(e="",t){var n;(n=this.events[e])==null||n.forEach(s=>s(t))}}a.myInstance=null;a.getInstance=()=>(a.myInstance==null&&(a.myInstance=new a),a.myInstance);a.ON_NODE_CHANGE="ON_NODE_CHANGE";a.ON_NODE_START_IN="ON_NODE_START_IN";a.ON_NODE_END_IN="ON_NODE_END_IN";a.ON_NODE_START_OUT="ON_NODE_START_OUT";a.ON_NODE_END_OUT="ON_NODE_END_OUT";a.ON_SWIPE_GESTURE="ON_SWIPE_GESTURE";a.ON_REQUEST_NEW_NODE="ON_REQUEST_NEW_NODE";a.ON_PROGRESS_LOADING="ON_PROGRESS_LOADING";a.ON_LOADING_COMPLETED="ON_LOADING_COMPLETED";a.ON_ORIENTATION_CHANGED="ON_ORIENTATION_CHANGED";class S extends Phaser.Scene{constructor(){super({key:"BackgroundScene",active:!0});d(this,"gameScene");d(this,"layer");d(this,"onChange",t=>{switch(t){case i.LEFT:this.x-=this.offset;break;case i.RIGHT:this.x+=this.offset;break;case i.TOP:this.y-=this.offset;break;case i.BOTTOM:this.y+=this.offset;break}this.tweens.add({targets:this.view,x:this.x,y:this.y,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})});this.offset=250,a.getInstance().subscribe(a.ON_NODE_CHANGE,this.onChange)}start(t){this.game=t,this.view=this.game.add.image(0,0,"bg").setOrigin(0,0),this.view.x=-1e3,this.view.y=-1e3,this.x=this.view.x,this.y=this.view.y}}class r{}r.W=0;r.H=0;r.fitToScreen=h=>{const e=r.W,t=r.W*(h.height/h.width);h.setDisplaySize(e,t);const n=r.W*.5-e*.5,s=r.H*.5-t*.5;h.x=n,h.y=s,console.log(`img w:${h.width} h:${h.height}`)};class O{constructor(e){console.log("Constructor de Logger"),this.logs=[],this.label=e.text}log(e){this.logs.unshift(this.getNum()+" "+e),this.label.text=this.logs.join(`
`)}getNum(){return this.logs.length+1}}O.myInstance=null;O.getInstance=h=>(O.myInstance==null&&(O.myInstance=new O(h)),O.myInstance);class p{constructor(e){console.log("Constructor de Orientation"),this.updateOrientation();const t=a.getInstance(),n=this;window.onresize=function(){n.updateOrientation(),t.notify(a.ON_ORIENTATION_CHANGED,{orientation:n.orientation})}}updateOrientation(){window.innerWidth>window.innerHeight?this.orientation=i.LANDSCAPE:this.orientation=i.PORTRAIT}}p.myInstance=null;p.getInstance=h=>(p.myInstance==null&&(p.myInstance=new p(h)),p.myInstance);class H extends Phaser.Scene{constructor(){super({key:"GameScene",active:!1});d(this,"cleanScenes",()=>{window.location.reload()});d(this,"addSection",({section:t,position:n})=>{t.setPosition(n),t.start({game:this,position:n}),this.sections.push(t)});d(this,"getSection",t=>this.sections.find(n=>n.id==t));d(this,"gotoNode",t=>{const n=this.getSection(t);if(this.currentNodeID!=null){const s=this.getSection(this.currentNodeID),o=this.getOutPosition(n.getPosition(),this.currentNodeID);console.log(`move started, currentNode:${this.currentNodeID}`);const c=this.currentNodeID;this.move(this.currentNodeID,o.top,o.left,()=>{this.globalevents.notify(a.ON_NODE_END_OUT,c)}),s.setPosition(o.positionResult)}this.globalevents.notify(a.ON_NODE_START_IN,t),this.globalevents.notify(a.ON_NODE_START_OUT,this.currentNodeID),this.move(t,0,0,()=>{this.globalevents.notify(a.ON_NODE_END_IN,this.currentNodeID)}),this.currentNodeID=t,this.globalevents.notify(a.ON_NODE_CHANGE,this.reversePosition(n.getPosition())),n.setPosition(i.CENTER)});d(this,"move",(t,n,s,o)=>{this.getSection(t).moveTo(n,s,o)});d(this,"getOutPosition",(t,n)=>{let s=0,o=0,c=i.LEFT,l=0;switch(t){case i.LEFT:s=this.W+l,c=i.RIGHT;break;case i.RIGHT:s=-(this.W+l),c=i.LEFT;break;case i.TOP:o=this.H+l,c=i.BOTTOM;break;case i.BOTTOM:o=-(this.H+l),c=i.TOP;break}return{top:o,left:s,positionResult:c}});d(this,"reversePosition",t=>{switch(t){case i.LEFT:return i.RIGHT;case i.RIGHT:return i.LEFT;case i.TOP:return i.BOTTOM;case i.BOTTOM:return i.TOP}})}preload(){console.log("preload"),this.orientationHelper=p.getInstance(),this.firstRunPortrait=this.orientationHelper.orientation==i.PORTRAIT,this.orientation=this.orientationHelper.orientation,console.log(`[preload] this.firstRunPortrait:${this.firstRunPortrait}`),console.log(`[preload] this.orientationHelper.orientation:${this.orientationHelper.orientation}`),console.log(`[preload] this.orientation:${this.orientation}`),r.H=this.scale.gameSize.height,r.W=this.scale.gameSize.width,console.log(r.W+" "+r.H),this.load.plugin("rexbbcodetextplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexbbcodetextplugin.min.js",!0),this.showDisplayMode()}onOrientationChange2(t){this.orientation=t.orientation,this.showDisplayMode()}create(){console.log("create"),this.sections=[],this.currentNode=void 0,this.safeArea=20,this.presentation1=this.scene.get("Presentation1"),this.addSection({section:this.presentation1,position:i.BOTTOM}),this.backgroundScene=this.scene.get("BackgroundScene"),this.backgroundScene.start(this),this.globalevents=a.getInstance(),this.globalevents.subscribe(a.ON_ORIENTATION_CHANGED,c=>{this.onOrientationChange2(c)}),this.testImg=this.add.image(0,0,"image_2").setOrigin(0,0);const t=r.W*.5-this.testImg.width*.5,n=r.H*.5-this.testImg.height*.5;console.log(`this.testImg.width:${this.testImg.width}`),this.testImg.x=t,this.testImg.y=n,r.fitToScreen(this.testImg),this.leftButton=this.add.image(0,0,"goBack_button").setOrigin(0,0),this.rightButton=this.add.image(0,0,"continue_button").setOrigin(0,0);const s=62;this.leftButton.x=s,this.leftButton.y=r.H-this.leftButton.height-s,this.rightButton.x=r.W-this.rightButton.width-s,this.rightButton.y=r.H-this.rightButton.height-s;const o=735;this.presentationText=this.add.text(0,0,"She logs onto a website and sees the first selection step",{fixedWidth:o,fontSize:"50px",fontFamily:"Arial",align:"center",wordWrap:{width:o,useAdvancedWrap:!0}}),this.presentationText.x=r.W*.5-this.presentationText.width*.5,this.presentationText.y=r.H-this.presentationText.height-s,this.logText=this.add.text(0,0,"",{align:"left",fontSize:30}),this.logText.x=this.safeArea,this.logger=O.getInstance({text:this.logText}),this.logger.log(`innerWidth:${window.innerWidth} innerHeight:${window.innerHeight}`),this.logger.log(`prop:${window.innerWidth/window.innerHeight}`),this.logger.log(`Screen.W:${r.W} Screen-H:${r.H}`),this.versionText=this.add.text(0,0,`v${i.version}`,{align:"right",fontSize:30}),this.versionText.x=r.W-this.versionText.width-this.safeArea,this.dimensions=this.add.text(0,0,"ddsdasdsdasdsadsda",{align:"right",fontSize:30}),this.dimensions.y=200,this.dimensions.setText(`window.innerWidth:${window.innerWidth} window.innerHeight${window.innerHeight}`),this.dimensions.x=r.W*.5-this.dimensions.width*.5}showDisplayMode(){console.log(`showDisplayMode:${this.orientation}`),this.orientation==i.LANDSCAPE?(document.getElementById("turn").style.display="none",this.firstRunPortrait&&this.cleanScenes()):document.getElementById("turn").style.display="block"}handler(t){t.setTint(16711680)}update(){this.sys.game.loop,this.dimensions.setText(`window.innerWidth:${window.innerWidth} window.innerHeight${window.innerHeight}`),this.dimensions.x=r.W*.5-this.dimensions.width*.5}}class y extends Phaser.Scene{constructor(e){super({key:e,active:!0}),this.id=e,this.globalevents=a.getInstance()}create({margin:e=0,position:t=i.LEFT}){switch(this.position=t,this.sectionW=r.W-e*2,this.sectionH=r.H-e*2,this.view=this.add.container(),t){case i.LEFT:this.view.x=-(r.W+e);break;case i.RIGHT:this.view.x=r.W+e;break;case i.TOP:this.view.y=-(r.H+e);break;case i.BOTTOM:this.view.y=r.H+e;break}}getPosition(){return this.position}setPosition(e){this.position=e}show(){this.tweens.add({targets:this.view,x:0,y:0,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})}moveTo(e,t,n){this.tweens.add({targets:this.view,x:e,y:t,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){n==null||n()}})}scaleImage({type:e,value:t,side:n,img:s}){const o=s.width,c=s.height,l=o/c,f=c/o;let g=0,u=0;e=="percent"?n=="width"?(g=o*t,u=f*g):(u=c*t,g=l*u):n=="width"?(g=t,u=f*g):(u=t,g=l*u),s.displayWidth=g,s.displayHeight=u}centerIMG(e){const t=e.displayWidth,n=e.displayHeight,s=this.scale.gameSize.width*.5-t*.5,o=this.scale.gameSize.height*.5-n*.5;return e.x=s,e.y=o,{x:s,y:o}}}class P{constructor({text:e,game:t,view:n,width:s=100,height:o=100,x:c=0,y:l=0,spriteName:f="bgButton",fontFamily:g='"Roboto", "Roboto-Bold", serif',color:u="white",fontSize:E=18,callback:I=void 0}){this.callback=I,this.button=t.add.container(),this.image=t.make.nineslice({x:0,y:0,key:f,width:s,height:o,leftWidth:0,rightWidth:0,topHeight:0,bottomHeight:0,add:!0}),this.text=t.add.rexBBCodeText(0,0,e,{fontFamily:g,fontSize:E,color:u}).setInteractive(),this.button.add(this.image),this.button.add(this.text),this.button.x=c,this.button.y=l,n.add(this.button),this.displayWidth=s,this.displayHeight=o;const _=this;this.text.on("pointerdown",function(){_.onClick()})}onClick(){var e;(e=this.callback)==null||e.call(this)}}class v extends y{constructor(){super("Presentation1")}start({game:e,position:t}){super.create({position:t}),this.game=e,this.perfume=this.game.add.image(0,0,"perfume").setOrigin(0,0).setInteractive(),this.perfume.name="perfume",this.view.add(this.perfume),this.scaleImage({img:this.perfume,type:"pixels",value:this.sectionH*.7,side:"height"}),this.centerIMG(this.perfume),this.textButton=new P({game:this.game,text:"SIGUIENTE",view:this.view,x:100,y:100,width:219,height:168,spriteName:"bgButton"}),this.game.make.nineslice({x:200,y:500,key:"splash",add:!0}),this.centerIMG(this.textButton),this.game.input.on("gameobjectdown",(n,s)=>{s.name=="perfume"&&(this.moveRandom(),this.globalevents.notify(a.ON_NODE_CHANGE,i.BOTTOM))})}moveRandom(){const e=Phaser.Math.Between(this.perfume.displayWidth,r.W-this.perfume.displayWidth),t=Phaser.Math.Between(this.perfume.displayHeight,r.H-this.perfume.displayHeight);this.tweens.add({targets:this.perfume,x:e,y:t,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})}}class D extends y{constructor(){super("Presentation2")}}class W extends Phaser.Scene{constructor(){super("PreloadScene")}preload(){this.load.image("splash","/splash.png"),this.load.image("perfume","/perfume.png"),this.load.image("bgButton","/buttons/bgButton.png"),this.load.image("bg","/background.jpg"),this.load.image("image_1","/960x540.png"),this.load.image("image_2","/1920x1080.png"),this.load.image("goBack_button","/goBack_button.png"),this.load.image("continue_button","/continue_button.png")}create(){console.log("Preloaded finished"),this.scene.switch("GameScene")}}console.log("Version: "+i.version);const m=window.innerWidth,N=window.innerHeight;console.log(`innerWidth:${m} innerHeight:${N}`);let T=1080,w=T*(m/N);N>m&&(w=T*(N/m));console.log(`w:${w} h:${T}`);const R={type:Phaser.CANVAS,backgroundColor:"#000000",antialiasGL:!1,scale:{mode:Phaser.Scale.NO_SCALE,parent:"content",width:w,height:T},scene:[W,H,S,v,D]};p.getInstance();new Phaser.Game(R);
