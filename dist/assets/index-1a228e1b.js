var w=Object.defineProperty;var y=(r,t,e)=>t in r?w(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var l=(r,t,e)=>(y(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();class i{}i.version="0.1.7";i.LEFT="LEFT";i.RIGHT="RIGHT";i.TOP="TOP";i.BOTTOM="BOTTOM";i.CENTER="CENTER";i.LANDSCAPE="LANDSCAPE";i.PORTRAIT="PORTRAIT";i.easing="Cubic.easeOut";i.safeArea=15;i.PRESENTATION_1="Presentation1";i.PRESENTATION_2="Presentation2";class h{}h.W=0;h.H=0;h.fitToScreen=r=>{const t=window.innerWidth/window.innerHeight;let e=0,n=0;t<1.7?(n=h.H,e=h.H*(r.width/r.height)):(e=h.W,n=h.W*(r.height/r.width)),r.setDisplaySize(e,n);const s=h.W*.5-e*.5,o=h.H*.5-n*.5;r.x=s,r.y=o};class a{constructor(){this.events={}}subscribe(t="",e){this.events[t]==null&&(this.events[t]=[]),this.events[t].push(e)}unsubscribe(t="",e){this.events[t]!=null&&(this.events[t]=this.events[t].filter(n=>n!==e))}notify(t="",e){var n;(n=this.events[t])==null||n.forEach(s=>s(e))}}a.myInstance=null;a.getInstance=()=>(a.myInstance==null&&(a.myInstance=new a),a.myInstance);a.ON_NODE_CHANGE="ON_NODE_CHANGE";a.ON_NODE_START_IN="ON_NODE_START_IN";a.ON_NODE_END_IN="ON_NODE_END_IN";a.ON_NODE_START_OUT="ON_NODE_START_OUT";a.ON_NODE_END_OUT="ON_NODE_END_OUT";a.ON_SWIPE_GESTURE="ON_SWIPE_GESTURE";a.ON_REQUEST_NEW_NODE="ON_REQUEST_NEW_NODE";a.ON_PROGRESS_LOADING="ON_PROGRESS_LOADING";a.ON_LOADING_COMPLETED="ON_LOADING_COMPLETED";a.ON_ORIENTATION_CHANGED="ON_ORIENTATION_CHANGED";class S{constructor(t){l(this,"onRequestNewNode",t=>{const{requestedNodeID:e}=t;this.gotoNode(e)});l(this,"addSection",({section:t,position:e})=>{t.setPosition(e),t.start({game:this.mainScene,position:e}),this.sections.push(t)});l(this,"getSection",t=>this.sections.find(e=>e.id==t));l(this,"gotoNode",t=>{const e=this.getSection(t);if(this.currentNodeID!=null){const n=this.getSection(this.currentNodeID),s=this.getOutPosition(e.getPosition(),this.currentNodeID),o=this.currentNodeID;this.move(this.currentNodeID,s.x,s.y,()=>{this.globalevents.notify(a.ON_NODE_END_OUT,o)}),n.setPosition(s.positionResult)}this.globalevents.notify(a.ON_NODE_START_IN,t),this.globalevents.notify(a.ON_NODE_START_OUT,this.currentNodeID),this.move(t,0,0,()=>{this.globalevents.notify(a.ON_NODE_END_IN,this.currentNodeID)}),this.currentNodeID=t,this.globalevents.notify(a.ON_NODE_CHANGE,this.reversePosition(e.getPosition())),e.setPosition(i.CENTER)});l(this,"move",(t,e,n,s)=>{this.getSection(t).moveTo(e,n,s)});l(this,"getOutPosition",(t,e)=>{let n=0,s=0,o=i.LEFT,c=0;switch(t){case i.LEFT:n=h.W+c,o=i.RIGHT;break;case i.RIGHT:n=-(h.W+c),o=i.LEFT;break;case i.TOP:s=h.H+c,o=i.BOTTOM;break;case i.BOTTOM:s=-(h.H+c),o=i.TOP;break}return{y:s,x:n,positionResult:o}});l(this,"reversePosition",t=>{switch(t){case i.LEFT:return i.RIGHT;case i.RIGHT:return i.LEFT;case i.TOP:return i.BOTTOM;case i.BOTTOM:return i.TOP}});this.create(t)}create(t){this.mainScene=t,this.globalevents=a.getInstance(),this.sections=[],this.currentNode=void 0,this.safeArea=20,this.presentation1=this.mainScene.scene.get(i.PRESENTATION_1),this.addSection({section:this.presentation1,position:i.RIGHT}),this.presentation2=this.mainScene.scene.get(i.PRESENTATION_2),this.addSection({section:this.presentation2,position:i.RIGHT}),this.gotoNode(i.PRESENTATION_1),this.globalevents.subscribe(a.ON_ORIENTATION_CHANGED,e=>{this.onOrientationChange2(e)}),this.globalevents.subscribe(a.ON_REQUEST_NEW_NODE,e=>{this.onRequestNewNode(e)})}}class N{constructor(t){console.log("Constructor de Logger"),this.logs=[],this.label=t.text}log(t){this.logs.unshift(this.getNum()+" "+t),this.label.text=this.logs.join(`
`)}getNum(){return this.logs.length+1}}N.myInstance=null;N.getInstance=r=>(N.myInstance==null&&(N.myInstance=new N(r)),N.myInstance);class O{constructor(t){console.log("Constructor de Version");const{scene:e,position:n}=t;n==i.LEFT?(this.versionText=e.add.text(0,0,`v${i.version}`,{align:"left",fontSize:30}),this.versionText.x=i.safeAreaa):(this.versionText=e.add.text(0,0,`v${i.version}`,{align:"right",fontSize:30}),this.versionText.x=h.W-this.versionText.width-i.safeArea),this.versionText.y=10}}O.myInstance=null;O.getInstance=r=>(O.myInstance==null&&(O.myInstance=new O(r)),O.myInstance);class d{constructor(t){console.log("Constructor de Orientation"),this.updateOrientation();const e=a.getInstance(),n=this;window.onresize=function(){n.updateOrientation(),e.notify(a.ON_ORIENTATION_CHANGED,{orientation:n.orientation})}}updateOrientation(){window.innerWidth>window.innerHeight?this.orientation=i.LANDSCAPE:this.orientation=i.PORTRAIT}}d.myInstance=null;d.getInstance=r=>(d.myInstance==null&&(d.myInstance=new d(r)),d.myInstance);function b(r,t,e,n,s){let o=Number(s.fontSize),c=r.add.rexBBCodeText(0,0,t,s);for(;c.height>n;)c.destroy(),o=o-1,s.fontSize=o,c=r.add.rexBBCodeText(0,0,t,s);return c}class x extends Phaser.Scene{constructor(){super({key:"GameScene",active:!1});l(this,"cleanScenes",()=>{window.location.reload()})}preload(){h.H=this.scale.gameSize.height,h.W=this.scale.gameSize.width,this.orientationHelper=d.getInstance(),this.firstRunPortrait=this.orientationHelper.orientation==i.PORTRAIT,this.orientation=this.orientationHelper.orientation,this.load.plugin("rexbbcodetextplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexbbcodetextplugin.min.js",!0),this.showDisplayMode()}onOrientationChange2(e){this.orientation=e.orientation,this.showDisplayMode()}create(){this.globalevents=a.getInstance(),this.globalevents.subscribe(a.ON_ORIENTATION_CHANGED,e=>{this.onOrientationChange2(e)}),this.backgroundScene=this.scene.get("BackgroundScene"),this.backgroundScene.start(this),this.sectionController=new S(this),this.logText=this.add.text(0,0,"",{align:"left",fontSize:30}),this.logText.x=i.safeArea,this.logText.y=20,this.logger=N.getInstance({text:this.logText}),this.logger.log(`innerWidth:${window.innerWidth} innerHeight:${window.innerHeight}`),this.logger.log(`prop:${window.innerWidth/window.innerHeight}`),this.logger.log(`Screen.W:${h.W} Screen-H:${h.H}`),O.getInstance({scene:this,position:i.RIGHT})}showDisplayMode(){console.log(`showDisplayMode:${this.orientation}`),this.orientation==i.LANDSCAPE?(document.getElementById("turn").style.display="none",this.firstRunPortrait&&this.cleanScenes()):document.getElementById("turn").style.display="block"}update(){}}class v extends Phaser.Scene{constructor(){super({key:"BackgroundScene",active:!0});l(this,"gameScene");l(this,"layer");l(this,"onChange",e=>{switch(e){case i.LEFT:this.x-=this.offset;break;case i.RIGHT:this.x+=this.offset;break;case i.TOP:this.y-=this.offset;break;case i.BOTTOM:this.y+=this.offset;break}this.tweens.add({targets:this.view,x:this.x,y:this.y,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})});this.offset=250,a.getInstance().subscribe(a.ON_NODE_CHANGE,this.onChange)}start(e){this.game=e,this.view=this.game.add.image(0,0,"bg").setOrigin(0,0),this.view.x=-1e3,this.view.y=-1e3,this.x=this.view.x,this.y=this.view.y}}class I extends Phaser.Scene{constructor(t){super({key:t,active:!0}),this.id=t,this.globalevents=a.getInstance()}create({margin:t=0,position:e=i.LEFT}){switch(this.position=e,this.sectionW=h.W-t*2,this.sectionH=h.H-t*2,this.view=this.add.container(),e){case i.LEFT:this.view.x=-(h.W+t);break;case i.RIGHT:this.view.x=h.W+t;break;case i.TOP:this.view.y=-(h.H+t);break;case i.BOTTOM:this.view.y=h.H+t;break}}getPosition(){return this.position}setPosition(t){this.position=t}gotoNode(t){this.globalevents.notify(a.ON_REQUEST_NEW_NODE,{requestedNodeID:t})}show(){this.tweens.add({targets:this.view,x:0,y:0,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})}moveTo(t,e,n){this.tweens.add({targets:this.view,x:t,y:e,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){n==null||n()}})}scaleImage({type:t,value:e,side:n,img:s}){const o=s.width,c=s.height,E=o/c,m=c/o;let g=0,u=0;t=="percent"?n=="width"?(g=o*e,u=m*g):(u=c*e,g=E*u):n=="width"?(g=e,u=m*g):(u=e,g=E*u),s.displayWidth=g,s.displayHeight=u}centerIMG(t){const e=t.displayWidth,n=t.displayHeight,s=this.scale.gameSize.width*.5-e*.5,o=this.scale.gameSize.height*.5-n*.5;return t.x=s,t.y=o,{x:s,y:o}}}class P extends I{constructor(){super("Presentation1")}start({game:t,position:e}){const n=this;super.create({position:e}),this.game=t,this.perfume=this.game.add.image(0,0,"perfume").setOrigin(0,0),this.perfume.name="perfume",this.view.add(this.perfume),this.scaleImage({img:this.perfume,type:"pixels",value:this.sectionH*.7,side:"height"}),this.centerIMG(this.perfume),this.leftButton=this.add.image(0,0,"goBack_button").setOrigin(0,0).setInteractive(),this.rightButton=this.add.image(0,0,"continue_button").setOrigin(0,0).setInteractive(),this.view.add(this.leftButton),this.view.add(this.rightButton);const s=62;this.leftButton.x=s,this.leftButton.y=h.H-this.leftButton.height-s,this.rightButton.x=h.W-this.rightButton.width-s,this.rightButton.y=h.H-this.rightButton.height-s,this.rightButton.on("pointerdown",function(o){n.globalevents.notify(a.ON_REQUEST_NEW_NODE,{requestedNodeID:i.PRESENTATION_2})}),this.game.input.on("gameobjectdown",(o,c)=>{c.name=="perfume"&&(this.moveRandom(),this.globalevents.notify(a.ON_NODE_CHANGE,i.BOTTOM))})}moveRandom(){const t=Phaser.Math.Between(this.perfume.displayWidth,h.W-this.perfume.displayWidth),e=Phaser.Math.Between(this.perfume.displayHeight,h.H-this.perfume.displayHeight);this.tweens.add({targets:this.perfume,x:t,y:e,duration:1e3,ease:i.easing,callbackScope:this,onComplete:function(){}})}}class D extends I{constructor(){super("Presentation2")}start({game:t,position:e}){const n=this;super.create({position:e});let s=100;const o=500,c=143;this.game=t,this.presentationText=b(this,"She logs onto a website and sees the first selection step",o,c,{fixedWidth:o,fontFamily:"Arial",align:"center",fontSize:50,wrap:{mode:"word",width:o}}),this.view.add(this.presentationText),this.presentationText.x=h.W*.5-o*.5,this.presentationText.y=h.H-this.presentationText.height-s,this.leftButton=this.add.image(0,0,"goBack_button").setOrigin(0,0).setInteractive(),this.view.add(this.leftButton),s=62,this.leftButton.x=s,this.leftButton.y=h.H-this.leftButton.height-s,this.leftButton.on("pointerdown",function(E){n.globalevents.notify(a.ON_REQUEST_NEW_NODE,{requestedNodeID:i.PRESENTATION_1})})}}class R extends Phaser.Scene{constructor(){super("PreloadScene")}preload(){this.load.image("splash","/splash.png"),this.load.image("perfume","/perfume.png"),this.load.image("bgButton","/buttons/bgButton.png"),this.load.image("bg","/background.jpg"),this.load.image("image_1","/960x540.png"),this.load.image("image_2","/1920x1080.png"),this.load.image("goBack_button","/goBack_button.png"),this.load.image("continue_button","/continue_button.png")}create(){console.log("Preloaded finished"),this.scene.switch("GameScene")}}console.log("Version: "+i.version);const f=window.innerWidth,T=window.innerHeight;console.log(`innerWidth:${f} innerHeight:${T}`);let p=1080,_=p*(f/T);T>f&&(_=p*(T/f));console.log(`final w:${_} h:${p}`);const H={type:Phaser.CANVAS,backgroundColor:"#000000",antialiasGL:!1,scale:{mode:Phaser.Scale.NO_SCALE,parent:"content",width:_,height:p},scene:[R,x,v,P,D]};d.getInstance();new Phaser.Game(H);
